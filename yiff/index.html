<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>ProjectTYS</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.1/css/all.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Archivo+Black">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Bitter:400,700">
    <link rel="stylesheet" href="assets/css/styles.min.css">
</head>

<body id="imgViewer" style="background-color: #311d3f;max-width: 100%;overflow: scroll;max-height: 100%;height: 99%;width: 99%;">
    <div>
        <div class="header-dark" style="background-color: #311d3f;background-image: url(&quot;null&quot;);">
            <nav class="navbar navbar-dark navbar-expand-md navigation-clean-search">
                <div class="container"><a class="navbar-brand" href="#">Project TYS</a><button class="navbar-toggler" data-toggle="collapse" data-target="#navcol-1"><span class="sr-only">Toggle navigation</span><span class="navbar-toggler-icon"></span></button>
                    <div class="collapse navbar-collapse"
                        id="navcol-1">
                        <!-- 
                        <ul class="nav navbar-nav">
                            <li class="nav-item" role="presentation"><a class="nav-link" href="#">Discover</a></li>
                            <li class="nav-item" role="presentation"><a class="nav-link" href="#" id="myStashBtn">My Stash</a></li>
                            <li class="nav-item" role="presentation"><a class="nav-link" href="#" id="signoutBtn">Log Out</a></li>
                            <li class="nav-item" role="presentation"><a class="nav-link" href="#">Report Bugs or suggest a feature!</a></li>
                        </ul>
                      -->
                    </div>
                </div>
            </nav>
        </div>
    </div>
    <div class="d-flex justify-content-center align-items-end" id="imgView" style="height: 100%;width: 100%;margin-top: -74px;"></div>
    <div class="d-flex justify-content-center align-items-end mb-auto fixed-bottom top">
     <!-- <button class="btn btn-primary btn btn-primary btn-circle btn-xl top" type="button" id="saveToStash"><i class="far fa-save" style="font-size: 32px;"></i></button>
     --><button class="btn btn-primary btn btn-secondary btn-circle btn-xl top" type="button" id="downloadBtn" style="margin-left: ;margin-right: 32px;"><i class="fas fa-download" style="font-size: 32px;"></i></button><button class="btn btn-primary btn btn-danger btn-circle btn-xl top" type="button" id="btnNext"><i class="fas fa-arrow-right" style="font-size: 32px;"></i></button></div>    <script
    src="https://code.jquery.com/jquery-3.4.1.min.js"32px
    integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
    crossorigin="anonymous"></script>   
<script type="module" src="https://cdnjs.cloudflare.com/ajax/libs/viewerjs/1.5.0/viewer.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/viewerjs/1.5.0/viewer.min.css" integrity="sha256-MpORFsKmYYmQvFqOG/2AbIcy09vQBwjfZDKM+Ri/m0Y=" crossorigin="anonymous" />
<script src="https://www.gstatic.com/firebasejs/7.12.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.12.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.12.0/firebase-database.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.12.0/firebase-analytics.js"></script>
<script>
   var rimgurl = ""
   const imgurl="https://api.furry.bot/v2/furry/yiff/gay"
$.getJSON(imgurl, function(result){
    console.log(result)
    console.log(result.images[0].url)
    var div = document.createElement("img")
    div.id="img"
    div.name=result.images[0].name
    div.src=result.images[0].url
    rimgurl=result.images[0].url
        div.setAttribute("class","imgViewImg")
    
    
    document.getElementById("imgView").appendChild(div)
    document.getElementById("img").style.display="none"
    // You should import the CSS file.
// import 'viewerjs/dist/viewer.css';
// import Viewer from 'viewerjs';

// View an image
const viewer = new Viewer(document.getElementById('img'), {
  inline: false,
    fullscreen: true,
    navbar: false,
    toolbar: false,
    title: false,
  viewed() {
    viewer.zoomTo(1);
  },
});
// Then, show the image by click it, or call `viewer.show()`.
viewer.show()
})
    function removeElement(elementId) {
    // Removes an element from the document
    var element = document.getElementById(elementId);
    element.parentNode.removeChild(element);
}
function next(){
    removeElement("img")
    document.getElementsByClassName("viewer-container viewer-backdrop viewer-fixed viewer-fade viewer-transition")[0].id = "img2"
    removeElement("img2")
$.getJSON(imgurl, function(result){
    console.log(result)
    console.log(result.images[0].url)
    var div = document.createElement("img")
       div.name=result.images[0].name
    div.id="img"
        div.setAttribute("class","imgViewImg")
    div.src=result.images[0].url
    rimgurl=result.images[0].url
    document.getElementById("imgView").appendChild(div)
     document.getElementById("img").style.display="none"
    // You should import the CSS file.
// import 'viewerjs/dist/viewer.css';
// import Viewer from 'viewerjs';

// View an image
const viewer = new Viewer(document.getElementById('img'), {
  inline: false,
    fullscreen: true,
    navbar: false,
    toolbar: false,
    title: false,
  viewed() {
    viewer.zoomTo(1);
  },
});
// Then, show the image by click it, or call `viewer.show()`.
viewer.show()
})
}
    document.getElementById("btnNext").addEventListener("click", function(){
next()
    });
   
    // Your web app's Firebase configuration
  var firebaseConfig = {
    apiKey: "AIzaSyCLrAxZyRc5Bg_BmsqwX_hNbpIJwwcdlac",
    authDomain: "b0x-788f8.firebaseapp.com",
    databaseURL: "https://b0x-788f8.firebaseio.com",
    projectId: "b0x-788f8",
    storageBucket: "b0x-788f8.appspot.com",
    messagingSenderId: "1078764008388",
    appId: "1:1078764008388:web:cf8c59c8fb059ce9ec6a91",
    measurementId: "G-ZD73C9E8H5"
  };
  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);
  firebase.analytics();
  var database = firebase.database();
  firebase.auth().onAuthStateChanged(function(user) {
  if (user) {
    // User is signed in.
    var displayName = user.displayName;
    var email = user.email;
    var emailVerified = user.emailVerified;
    var photoURL = user.photoURL;
    var isAnonymous = user.isAnonymous;
    var uid = user.uid;
    var providerData = user.providerData;
    // ...
      console.log("Logged in!")
      //Redirect user to main page
  } else {
    // User is signed out.
    // ...
      console.log("Not logged in :c")
      //Redirect user to login page
      //location.href = "./index.html"
  }
});
  // Set the configuration for your app
  // TODO: Replace with your project's config object
  //EXAMPLE
  //addToStash("JayyOwO","https://i.furcdn.net/V2/furry/nsfw/yiff/gay/qQu0rZbJ020h3B1pFSkiw8pyfwoZIx.png");

  function addToStash(userid, url) {
      url=rimgurl
      userid=firebase.auth().currentUser.displayName
id = btoa(url)
  firebase.database().ref('users/' + userid + "/" + id).set({
    url: url
  });
}
  function dev_addToStash(userId, url) {
id = btoa(url)
  firebase.database().ref('users/' + userId + "/" + id).set({
    url: url
  });
}
        document.getElementById("saveToStash").addEventListener("click", function(){
addToStash()
    });
    function download(){
forceDownload(document.getElementById("img").src, "ProjectTYS_" + document.getElementById("img").name)
}
            document.getElementById("downloadBtn").addEventListener("click", function(){
download();
    });
            document.getElementById("signoutBtn").addEventListener("click", function(){
    firebase.auth().signOut().then(function() {
  // Sign-out successful.
}).catch(function(error) {
  // An error happened.
});
    });

    function forceDownload(url, fileName){
    var xhr = new XMLHttpRequest();
    xhr.open("GET", url, true);
    xhr.responseType = "blob";
    xhr.onload = function(){
        var urlCreator = window.URL || window.webkitURL;
        var imageUrl = urlCreator.createObjectURL(this.response);
        var tag = document.createElement('a');
        tag.href = imageUrl;
        tag.download = fileName;
        document.body.appendChild(tag);
        tag.click();
        document.body.removeChild(tag);
    }
    xhr.send();
}
                     document.getElementById("myStashBtn").addEventListener("click", function(){
location.href = "./myStash.html"
    });
</script>

    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.bundle.min.js"></script>
</body>

</html>